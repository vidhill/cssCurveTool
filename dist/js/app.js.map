{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/app.js","src/js/dom/create-keyframe.js","src/js/dom/setup.js","src/js/factory/calculate-y-pos-factory.js","src/js/factory/create-timepoint-factory.js","src/js/factory/keyframe-store-factory.js","src/js/helpers.js","src/js/path-calculation/create-segments.js","src/js/points-to-cubic.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Created by davidhill on 11/07/2016.\n */\n\n// import helpers from './helpers.js';\nimport init from './dom/setup.js';\nimport pointsToCubic from './points-to-cubic.js';\n\nimport keyFrameFactory from './factory/keyframe-store-factory';\nimport createTimePointFactory from './factory/create-timepoint-factory.js';\nimport calculateYPosFactory from './factory/calculate-y-pos-factory.js';\n\nimport createSegments from './path-calculation/create-segments.js';\n\nconst keyFrameStore = keyFrameFactory();\n\n\nconst docSetting = {\n    width: 800,\n    height: 500,\n    sidePad: 40,\n    bottomPad: 100,\n    bgColour: '#bada55'\n};\n\n// create holder svg element\nconst doc = Snap(docSetting.width, docSetting.height);\n\n// draw background\ndoc.rect(0, 0, docSetting.width, docSetting.height).attr({\n    fill: docSetting.bgColour\n});\n\n// create a group element to contain all elements\nconst containAll = doc.g();\nconst timeLine = init(containAll, docSetting);\n\nvar calculateXpos = function(perc){\n    return timeLine.width * perc;\n};\n\nconst createTimePoint = createTimePointFactory(containAll, timeLine);\n\nfunction addKeyFramesToTimeline(keyFrames) {\n\n    var valsArr = keyFrames.map(key => key.opacity);\n\n    var maxMin = {\n        maxVal: Math.max(...valsArr),\n        minVal: Math.min(...valsArr)\n    };\n\n    var calculateYpos = calculateYPosFactory(maxMin, timeLine.height, timeLine.yPos);\n\n    var points = keyFrames.map(keyFrame => {\n        return {\n            x: calculateXpos(keyFrame.offset),\n            y: calculateYpos(keyFrame.opacity),\n            offset: keyFrame.offset\n        };\n    });\n\n    var pointArr = points.reduce(pointsToCubic, []);\n    var bezierPath = createSegments(pointArr);\n\n\n    containAll.path(bezierPath)\n        .attr({\n            stroke: '#FF0000',\n            strokeWidth: 2,\n            fill: 'none'\n        });\n\n\n    const timePoints = pointArr.map(function(point){\n\n        let pointObj = createTimePoint(point);\n        containAll.add(pointObj.group);\n\n        return pointObj;\n\n    });\n\n        //timePoints[1].updatePoint();\n\n        // move everting over to the right\n    containAll.transform(`translate(${docSetting.sidePad} 0)`);\n\n    return timePoints;\n}\n\n\nlet myKeyFrames = [\n    { transform: 'scale(1)', opacity: 1, offset: 0 },\n    { transform: 'scale(.5)', opacity: 0, offset: .33333 },\n    { transform: 'scale(.667)', opacity: 0.5, offset: .66666 },\n    { transform: 'scale(.6)', opacity: 0, offset: 1 }\n];\n\nlet currKeyFrames = keyFrameStore.setKeyFrames(myKeyFrames);\n\naddKeyFramesToTimeline(currKeyFrames);\n","\n\nconst thumbDimensions = {\n    width: 5,\n    height: 15\n};\n\nexport default function(refContain, group, timeLine){\n    refContain.line = group.path(`M0,${timeLine.yPos},v-${timeLine.height}`)\n        .attr({\n            stroke: '#000',\n            strokeOpacity: 0.5,\n            strokeWidth: 1\n        });\n\n    refContain.thumb = group.rect(0, timeLine.yPos , thumbDimensions.width, thumbDimensions.height)\n        .transform(`translate(-${thumbDimensions.width/2} -${thumbDimensions.height/2})`);\n\n\n    refContain.labelText = group.text(0, timeLine.yPos + 30, '')\n        .attr({\n            textAnchor: 'middle'\n        });\n\n    refContain.timeText = group.text(0, timeLine.yPos + 60, '')\n        .attr({\n            textAnchor: 'middle'\n        });\n\n    refContain.pathPoint = group.circle(0, 0, 5);\n\n    return refContain;\n}\n","/**\n * Created by davidhill on 12/07/2016.\n */\n\nexport default function (snap, docSetting) {\n    var tLineSetting = {\n        width: (docSetting.width - (docSetting.sidePad * 2)),\n        height: 300,\n        yPos: docSetting.height - docSetting.bottomPad\n    };\n\n    // draw timeline\n    tLineSetting.objRef = snap.path(`M0 ${tLineSetting.yPos} h${tLineSetting.width}`)\n        .attr({\n            stroke: '#000',\n            strokeWidth: 1\n        });\n\n    return tLineSetting;\n}\n","\nexport default function (minMaxVals, maxHeightRange, zeroYPosition) {\n\n    const { maxVal, minVal } = minMaxVals;\n    const distance = maxVal - minVal;\n\n    return function(val){\n        const fractionTotal = (val + Math.abs(minVal))/distance;\n        return zeroYPosition - (maxHeightRange * fractionTotal);\n    };\n}\n","/**\n * Created by davidhill on 27/07/2016.\n */\n\nimport helpers from '../helpers.js';\nimport renderKeyFrame from '../dom/create-keyframe.js';\n\nfunction drawHandle(point, curvePoint, doc) {\n\n    let objectRef = {};\n\n    let handleColour = '#0000AA';\n    let handleSetting = {\n        stroke: handleColour,\n        strokeWidth: 1\n    };\n\n    objectRef.line = doc.line(point.x, point.y, curvePoint.x, curvePoint.y)\n        .attr(handleSetting);\n    objectRef.circle = doc.circle(curvePoint.x, curvePoint.y, 5)\n        .attr({\n            fill: handleColour\n        });\n    //.drag();\n\n    return objectRef;\n\n}\n\n\nexport default function(doc, timeLine) {\n\n    return function(point) {\n        var refContain = {\n            updatePoint(newPoint){\n                this.setLabelText( helpers.decimalToPercentage(newPoint.offset) );\n                this.setTimeText( helpers.toTimeScale(newPoint.offset, 500) );\n                this.setPathPointYPos(newPoint.y);\n            },\n            setLabelText(text){\n                this.labelText.node.textContent = text;\n            },\n            setTimeText(text){\n                this.timeText.node.textContent = text;\n            },\n            setPathPointYPos(yPos){\n                this.pathPoint.attr({cy: yPos});\n            }\n        };\n\n        var g = doc.g(); // group to hold\n\n        g.transform(`translate(${point.x} 0)`);\n\n        refContain = renderKeyFrame(refContain, g, timeLine);\n\n        refContain.updatePoint(point);\n\n        if(helpers.isObject(point.forwardCurve)){\n            refContain.forwardHandle = drawHandle(point, point.forwardCurve, doc);\n        }\n\n        if(helpers.isObject(point.backwardCurve)){\n            refContain.backHandle = drawHandle(point, point.backwardCurve, doc);\n        }\n\n        //g.drag();\n\n        refContain.group = g;\n\n        return refContain;\n    };\n\n}\n","/**\n * Created by davidhill on 02/08/2016.\n */\n\n\nexport default function () {\n    let keyFrames = [];\n\n    return {\n        setKeyFrames(keys){\n            keyFrames = keys;\n            return keyFrames;\n\n        },\n        getKeyFrames(){\n            return keyFrames;\n        },\n        addKeyFrame(key){\n            if(key.hasOwnProperty('offset')){\n                keyFrames.push(key);\n            } else {\n                throw new TypeError('Keyframes should have an offset property');\n            }\n        },\n        removeKeyFrame(index){\n            keyFrames.splice(index, 1);\n            return keyFrames;\n        },\n        updateKeyOffset(index, newOffset){\n            keyFrames[index].offset = newOffset;\n            return keyFrames[index];\n        }\n\n    };\n}\n","\nexport default {\n    isObject: function(value){\n        return value !== null && typeof value === 'object'; // courtesy of angularjs\n    },\n    decimalToPercentage: function(dec){\n        return ( dec * 100 ).toFixed(2) + '%';\n    },\n    toTimeScale: function (val, total) {\n        return (total*val).toFixed(2) + 'ms';\n    },\n    toSpacedString: function (...strings) {\n        return strings.join(' ');\n    }\n};\n","import helpers from '../helpers.js';\n\nexport const segmentMethods = {\n    cubicBezier(pointA, pointB) {\n        let controlPoint = [];\n\n        controlPoint[0] = 'M' + helpers.toSpacedString(pointA.x, pointA.y);\n        controlPoint[1] = 'C' + helpers.toSpacedString(pointA.forwardCurve.x, pointA.forwardCurve.y);\n\n        controlPoint[2] = helpers.toSpacedString(pointB.backwardCurve.x, pointB.backwardCurve.y);\n        controlPoint[3] = helpers.toSpacedString(pointB.x, pointB.y);\n\n        return controlPoint.join(' ');\n\n    }\n};\n\nexport default function(pointsArray) {\n\n    let result,\n        pathStrArr = [];\n\n    for(let i = 0, len = pointsArray.length - 1; i < len; i++ ){\n        // curve between current point and next\n        result = segmentMethods.cubicBezier(pointsArray[i], pointsArray[i+1]);\n        pathStrArr.push(result);\n    }\n\n    return pathStrArr.join(' ');\n\n}\n","\n\nexport default function (prevVal, point, ind, srcArr){\n\n    let prevPoint = srcArr[ind - 1];\n    let nextPoint = srcArr[ind + 1];\n\n    if(prevPoint !== undefined){\n        let xDiff = point.x - prevPoint.x;\n\n        // easeOut = cubic-bezier(0,0, 0.58,1)\n        point.backwardCurve = {\n            x: point.x - (xDiff * 0.58), //\n            y: point.y // 1\n        };\n\n    }\n\n    if(nextPoint !== undefined) {\n        let xDiff = nextPoint.x - point.x;\n\n        // easeIn = cubic-bezier(0.42,0, 1,1)\n        point.forwardCurve = {\n            x: point.x + ( xDiff * 0.42 ),\n            y: point.y // 0\n        };\n\n    }\n\n    prevVal.push(point);\n\n    return prevVal;\n\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXBwLmpzIiwic3JjL2pzL2RvbS9jcmVhdGUta2V5ZnJhbWUuanMiLCJzcmMvanMvZG9tL3NldHVwLmpzIiwic3JjL2pzL2ZhY3RvcnkvY2FsY3VsYXRlLXktcG9zLWZhY3RvcnkuanMiLCJzcmMvanMvZmFjdG9yeS9jcmVhdGUtdGltZXBvaW50LWZhY3RvcnkuanMiLCJzcmMvanMvZmFjdG9yeS9rZXlmcmFtZS1zdG9yZS1mYWN0b3J5LmpzIiwic3JjL2pzL2hlbHBlcnMuanMiLCJzcmMvanMvcGF0aC1jYWxjdWxhdGlvbi9jcmVhdGUtc2VnbWVudHMuanMiLCJzcmMvanMvcG9pbnRzLXRvLWN1YmljLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNLQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUE7Ozs7OztvTUFaQTs7OztBQUlBOzs7QUFVQSxJQUFNLGdCQUFnQixxQ0FBdEI7O0FBR0EsSUFBTSxhQUFhO0FBQ2YsV0FBTyxHQURRO0FBRWYsWUFBUSxHQUZPO0FBR2YsYUFBUyxFQUhNO0FBSWYsZUFBVyxHQUpJO0FBS2YsY0FBVTtBQUxLLENBQW5COztBQVFBO0FBQ0EsSUFBTSxNQUFNLEtBQUssV0FBVyxLQUFoQixFQUF1QixXQUFXLE1BQWxDLENBQVo7O0FBRUE7QUFDQSxJQUFJLElBQUosQ0FBUyxDQUFULEVBQVksQ0FBWixFQUFlLFdBQVcsS0FBMUIsRUFBaUMsV0FBVyxNQUE1QyxFQUFvRCxJQUFwRCxDQUF5RDtBQUNyRCxVQUFNLFdBQVc7QUFEb0MsQ0FBekQ7O0FBSUE7QUFDQSxJQUFNLGFBQWEsSUFBSSxDQUFKLEVBQW5CO0FBQ0EsSUFBTSxXQUFXLHFCQUFLLFVBQUwsRUFBaUIsVUFBakIsQ0FBakI7O0FBRUEsSUFBSSxnQkFBZ0IsU0FBaEIsYUFBZ0IsQ0FBUyxJQUFULEVBQWM7QUFDOUIsV0FBTyxTQUFTLEtB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QU4sR0FBcUI7QUFDakIsZUFBRyxNQUFNLENBQU4sR0FBWSxTQUFRLElBRE47QUFFakIsZUFBRyxNQUFNLENBRlEsQ0FFTjtBQUZNLFNBQXJCO0FBS0g7O0FBRUQsWUFBUSxJQUFSLENBQWEsS0FBYjs7QUFFQSxXQUFPLE9BQVA7QUFFSCxDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKlxuICogQ3JlYXRlZCBieSBkYXZpZGhpbGwgb24gMTEvMDcvMjAxNi5cbiAqL1xuXG4vLyBpbXBvcnQgaGVscGVycyBmcm9tICcuL2hlbHBlcnMuanMnO1xuaW1wb3J0IGluaXQgZnJvbSAnLi9kb20vc2V0dXAuanMnO1xuaW1wb3J0IHBvaW50c1RvQ3ViaWMgZnJvbSAnLi9wb2ludHMtdG8tY3ViaWMuanMnO1xuXG5pbXBvcnQga2V5RnJhbWVGYWN0b3J5IGZyb20gJy4vZmFjdG9yeS9rZXlmcmFtZS1zdG9yZS1mYWN0b3J5JztcbmltcG9ydCBjcmVhdGVUaW1lUG9pbnRGYWN0b3J5IGZyb20gJy4vZmFjdG9yeS9jcmVhdGUtdGltZXBvaW50LWZhY3RvcnkuanMnO1xuaW1wb3J0IGNhbGN1bGF0ZVlQb3NGYWN0b3J5IGZyb20gJy4vZmFjdG9yeS9jYWxjdWxhdGUteS1wb3MtZmFjdG9yeS5qcyc7XG5cbmltcG9ydCBjcmVhdGVTZWdtZW50cyBmcm9tICcuL3BhdGgtY2FsY3VsYXRpb24vY3JlYXRlLXNlZ21lbnRzLmpzJztcblxuY29uc3Qga2V5RnJhbWVTdG9yZSA9IGtleUZyYW1lRmFjdG9yeSgpO1xuXG5cbmNvbnN0IGRvY1NldHRpbmcgPSB7XG4gICAgd2lkdGg6IDgwMCxcbiAgICBoZWlnaHQ6IDUwMCxcbiAgICBzaWRlUGFkOiA0MCxcbiAgICBib3R0b21QYWQ6IDEwMCxcbiAgICBiZ0NvbG91cjogJyNiYWRhNTUnXG59O1xuXG4vLyBjcmVhdGUgaG9sZGVyIHN2ZyBlbGVtZW50XG5jb25zdCBkb2MgPSBTbmFwKGRvY1NldHRpbmcud2lkdGgsIGRvY1NldHRpbmcuaGVpZ2h0KTtcblxuLy8gZHJhdyBiYWNrZ3JvdW5kXG5kb2MucmVjdCgwLCAwLCBkb2NTZXR0aW5nLndpZHRoLCBkb2NTZXR0aW5nLmhlaWdodCkuYXR0cih7XG4gICAgZmlsbDogZG9jU2V0dGluZy5iZ0NvbG91clxufSk7XG5cbi8vIGNyZWF0ZSBhIGdyb3VwIGVsZW1lbnQgdG8gY29udGFpbiBhbGwgZWxlbWVudHNcbmNvbnN0IGNvbnRhaW5BbGwgPSBkb2MuZygpO1xuY29uc3QgdGltZUxpbmUgPSBpbml0KGNvbnRhaW5BbGwsIGRvY1NldHRpbmcpO1xuXG52YXIgY2FsY3VsYXRlWHBvcyA9IGZ1bmN0aW9uKHBlcmMpe1xuICAgIHJldHVybiB0aW1lTGluZS53aWR0aCAqIHBlcmM7XG59O1xuXG5jb25zdCBjcmVhdGVUaW1lUG9pbnQgPSBjcmVhdGVUaW1lUG9pbnRGYWN0b3J5KGNvbnRhaW5BbGwsIHRpbWVMaW5lKTtcblxuZnVuY3Rpb24gYWRkS2V5RnJhbWVzVG9UaW1lbGluZShrZXlGcmFtZXMpIHtcblxuICAgIHZhciB2YWxzQXJyID0ga2V5RnJhbWVzLm1hcChrZXkgPT4ga2V5Lm9wYWNpdHkpO1xuXG4gICAgdmFyIG1heE1pbiA9IHtcbiAgICAgICAgbWF4VmFsOiBNYXRoLm1heCguLi52YWxzQXJyKSxcbiAgICAgICAgbWluVmFsOiBNYXRoLm1pbiguLi52YWxzQXJyKVxuICAgIH07XG5cbiAgICB2YXIgY2FsY3VsYXRlWXBvcyA9IGNhbGN1bGF0ZVlQb3NGYWN0b3J5KG1heE1pbiwgdGltZUxpbmUuaGVpZ2h0LCB0aW1lTGluZS55UG9zKTtcblxuICAgIHZhciBwb2ludHMgPSBrZXlGcmFtZXMubWFwKGtleUZyYW1lID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IGNhbGN1bGF0ZVhwb3Moa2V5RnJhbWUub2Zmc2V0KSxcbiAgICAgICAgICAgIHk6IGNhbGN1bGF0ZVlwb3Moa2V5RnJhbWUub3BhY2l0eSksXG4gICAgICAgICAgICBvZmZzZXQ6IGtleUZyYW1lLm9mZnNldFxuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgdmFyIHBvaW50QXJyID0gcG9pbnRzLnJlZHVjZShwb2ludHNUb0N1YmljLCBbXSk7XG4gICAgdmFyIGJlemllclBhdGggPSBjcmVhdGVTZWdtZW50cyhwb2ludEFycik7XG5cblxuICAgIGNvbnRhaW5BbGwucGF0aChiZXppZXJQYXRoKVxuICAgICAgICAuYXR0cih7XG4gICAgICAgICAgICBzdHJva2U6ICcjRkYwMDAwJyxcbiAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAyLFxuICAgICAgICAgICAgZmlsbDogJ25vbmUnXG4gICAgICAgIH0pO1xuXG5cbiAgICBjb25zdCB0aW1lUG9pbnRzID0gcG9pbnRBcnIubWFwKGZ1bmN0aW9uKHBvaW50KXtcblxuICAgICAgICBsZXQgcG9pbnRPYmogPSBjcmVhdGVUaW1lUG9pbnQocG9pbnQpO1xuICAgICAgICBjb250YWluQWxsLmFkZChwb2ludE9iai5ncm91cCk7XG5cbiAgICAgICAgcmV0dXJuIHBvaW50T2JqO1xuXG4gICAgfSk7XG5cbiAgICAgICAgLy90aW1lUG9pbnRzWzFdLnVwZGF0ZVBvaW50KCk7XG5cbiAgICAgICAgLy8gbW92ZSBldmVydGluZyBvdmVyIHRvIHRoZSByaWdodFxuICAgIGNvbnRhaW5BbGwudHJhbnNmb3JtKGB0cmFuc2xhdGUoJHtkb2NTZXR0aW5nLnNpZGVQYWR9IDApYCk7XG5cbiAgICByZXR1cm4gdGltZVBvaW50cztcbn1cblxuXG5sZXQgbXlLZXlGcmFtZXMgPSBbXG4gICAgeyB0cmFuc2Zvcm06ICdzY2FsZSgxKScsIG9wYWNpdHk6IDEsIG9mZnNldDogMCB9LFxuICAgIHsgdHJhbnNmb3JtOiAnc2NhbGUoLjUpJywgb3BhY2l0eTogMCwgb2Zmc2V0OiAuMzMzMzMgfSxcbiAgICB7IHRyYW5zZm9ybTogJ3NjYWxlKC42NjcpJywgb3BhY2l0eTogMC41LCBvZmZzZXQ6IC42NjY2NiB9LFxuICAgIHsgdHJhbnNmb3JtOiAnc2NhbGUoLjYpJywgb3BhY2l0eTogMCwgb2Zmc2V0OiAxIH1cbl07XG5cbmxldCBjdXJyS2V5RnJhbWVzID0ga2V5RnJhbWVTdG9yZS5zZXRLZXlGcmFtZXMobXlLZXlGcmFtZXMpO1xuXG5hZGRLZXlGcmFtZXNUb1RpbWVsaW5lKGN1cnJLZXlGcmFtZXMpO1xuIiwiXG5cbmNvbnN0IHRodW1iRGltZW5zaW9ucyA9IHtcbiAgICB3aWR0aDogNSxcbiAgICBoZWlnaHQ6IDE1XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihyZWZDb250YWluLCBncm91cCwgdGltZUxpbmUpe1xuICAgIHJlZkNvbnRhaW4ubGluZSA9IGdyb3VwLnBhdGgoYE0wLCR7dGltZUxpbmUueVBvc30sdi0ke3RpbWVMaW5lLmhlaWdodH1gKVxuICAgICAgICAuYXR0cih7XG4gICAgICAgICAgICBzdHJva2U6ICcjMDAwJyxcbiAgICAgICAgICAgIHN0cm9rZU9wYWNpdHk6IDAuNSxcbiAgICAgICAgICAgIHN0cm9rZVdpZHRoOiAxXG4gICAgICAgIH0pO1xuXG4gICAgcmVmQ29udGFpbi50aHVtYiA9IGdyb3VwLnJlY3QoMCwgdGltZUxpbmUueVBvcyAsIHRodW1iRGltZW5zaW9ucy53aWR0aCwgdGh1bWJEaW1lbnNpb25zLmhlaWdodClcbiAgICAgICAgLnRyYW5zZm9ybShgdHJhbnNsYXRlKC0ke3RodW1iRGltZW5zaW9ucy53aWR0aC8yfSAtJHt0aHVtYkRpbWVuc2lvbnMuaGVpZ2h0LzJ9KWApO1xuXG5cbiAgICByZWZDb250YWluLmxhYmVsVGV4dCA9IGdyb3VwLnRleHQoMCwgdGltZUxpbmUueVBvcyArIDMwLCAnJylcbiAgICAgICAgLmF0dHIoe1xuICAgICAgICAgICAgdGV4dEFuY2hvcjogJ21pZGRsZSdcbiAgICAgICAgfSk7XG5cbiAgICByZWZDb250YWluLnRpbWVUZXh0ID0gZ3JvdXAudGV4dCgwLCB0aW1lTGluZS55UG9zICsgNjAsICcnKVxuICAgICAgICAuYXR0cih7XG4gICAgICAgICAgICB0ZXh0QW5jaG9yOiAnbWlkZGxlJ1xuICAgICAgICB9KTtcblxuICAgIHJlZkNvbnRhaW4ucGF0aFBvaW50ID0gZ3JvdXAuY2lyY2xlKDAsIDAsIDUpO1xuXG4gICAgcmV0dXJuIHJlZkNvbnRhaW47XG59XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgZGF2aWRoaWxsIG9uIDEyLzA3LzIwMTYuXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKHNuYXAsIGRvY1NldHRpbmcpIHtcbiAgICB2YXIgdExpbmVTZXR0aW5nID0ge1xuICAgICAgICB3aWR0aDogKGRvY1NldHRpbmcud2lkdGggLSAoZG9jU2V0dGluZy5zaWRlUGFkICogMikpLFxuICAgICAgICBoZWlnaHQ6IDMwMCxcbiAgICAgICAgeVBvczogZG9jU2V0dGluZy5oZWlnaHQgLSBkb2NTZXR0aW5nLmJvdHRvbVBhZFxuICAgIH07XG5cbiAgICAvLyBkcmF3IHRpbWVsaW5lXG4gICAgdExpbmVTZXR0aW5nLm9ialJlZiA9IHNuYXAucGF0aChgTTAgJHt0TGluZVNldHRpbmcueVBvc30gaCR7dExpbmVTZXR0aW5nLndpZHRofWApXG4gICAgICAgIC5hdHRyKHtcbiAgICAgICAgICAgIHN0cm9rZTogJyMwMDAnLFxuICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDFcbiAgICAgICAgfSk7XG5cbiAgICByZXR1cm4gdExpbmVTZXR0aW5nO1xufVxuIiwiXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAobWluTWF4VmFscywgbWF4SGVpZ2h0UmFuZ2UsIHplcm9ZUG9zaXRpb24pIHtcblxuICAgIGNvbnN0IHsgbWF4VmFsLCBtaW5WYWwgfSA9IG1pbk1heFZhbHM7XG4gICAgY29uc3QgZGlzdGFuY2UgPSBtYXhWYWwgLSBtaW5WYWw7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24odmFsKXtcbiAgICAgICAgY29uc3QgZnJhY3Rpb25Ub3RhbCA9ICh2YWwgKyBNYXRoLmFicyhtaW5WYWwpKS9kaXN0YW5jZTtcbiAgICAgICAgcmV0dXJuIHplcm9ZUG9zaXRpb24gLSAobWF4SGVpZ2h0UmFuZ2UgKiBmcmFjdGlvblRvdGFsKTtcbiAgICB9O1xufVxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhdmlkaGlsbCBvbiAyNy8wNy8yMDE2LlxuICovXG5cbmltcG9ydCBoZWxwZXJzIGZyb20gJy4uL2hlbHBlcnMuanMnO1xuaW1wb3J0IHJlbmRlcktleUZyYW1lIGZyb20gJy4uL2RvbS9jcmVhdGUta2V5ZnJhbWUuanMnO1xuXG5mdW5jdGlvbiBkcmF3SGFuZGxlKHBvaW50LCBjdXJ2ZVBvaW50LCBkb2MpIHtcblxuICAgIGxldCBvYmplY3RSZWYgPSB7fTtcblxuICAgIGxldCBoYW5kbGVDb2xvdXIgPSAnIzAwMDBBQSc7XG4gICAgbGV0IGhhbmRsZVNldHRpbmcgPSB7XG4gICAgICAgIHN0cm9rZTogaGFuZGxlQ29sb3VyLFxuICAgICAgICBzdHJva2VXaWR0aDogMVxuICAgIH07XG5cbiAgICBvYmplY3RSZWYubGluZSA9IGRvYy5saW5lKHBvaW50LngsIHBvaW50LnksIGN1cnZlUG9pbnQueCwgY3VydmVQb2ludC55KVxuICAgICAgICAuYXR0cihoYW5kbGVTZXR0aW5nKTtcbiAgICBvYmplY3RSZWYuY2lyY2xlID0gZG9jLmNpcmNsZShjdXJ2ZVBvaW50LngsIGN1cnZlUG9pbnQueSwgNSlcbiAgICAgICAgLmF0dHIoe1xuICAgICAgICAgICAgZmlsbDogaGFuZGxlQ29sb3VyXG4gICAgICAgIH0pO1xuICAgIC8vLmRyYWcoKTtcblxuICAgIHJldHVybiBvYmplY3RSZWY7XG5cbn1cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihkb2MsIHRpbWVMaW5lKSB7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24ocG9pbnQpIHtcbiAgICAgICAgdmFyIHJlZkNvbnRhaW4gPSB7XG4gICAgICAgICAgICB1cGRhdGVQb2ludChuZXdQb2ludCl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRMYWJlbFRleHQoIGhlbHBlcnMuZGVjaW1hbFRvUGVyY2VudGFnZShuZXdQb2ludC5vZmZzZXQpICk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUaW1lVGV4dCggaGVscGVycy50b1RpbWVTY2FsZShuZXdQb2ludC5vZmZzZXQsIDUwMCkgKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFBhdGhQb2ludFlQb3MobmV3UG9pbnQueSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0TGFiZWxUZXh0KHRleHQpe1xuICAgICAgICAgICAgICAgIHRoaXMubGFiZWxUZXh0Lm5vZGUudGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldFRpbWVUZXh0KHRleHQpe1xuICAgICAgICAgICAgICAgIHRoaXMudGltZVRleHQubm9kZS50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0UGF0aFBvaW50WVBvcyh5UG9zKXtcbiAgICAgICAgICAgICAgICB0aGlzLnBhdGhQb2ludC5hdHRyKHtjeTogeVBvc30pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnID0gZG9jLmcoKTsgLy8gZ3JvdXAgdG8gaG9sZFxuXG4gICAgICAgIGcudHJhbnNmb3JtKGB0cmFuc2xhdGUoJHtwb2ludC54fSAwKWApO1xuXG4gICAgICAgIHJlZkNvbnRhaW4gPSByZW5kZXJLZXlGcmFtZShyZWZDb250YWluLCBnLCB0aW1lTGluZSk7XG5cbiAgICAgICAgcmVmQ29udGFpbi51cGRhdGVQb2ludChwb2ludCk7XG5cbiAgICAgICAgaWYoaGVscGVycy5pc09iamVjdChwb2ludC5mb3J3YXJkQ3VydmUpKXtcbiAgICAgICAgICAgIHJlZkNvbnRhaW4uZm9yd2FyZEhhbmRsZSA9IGRyYXdIYW5kbGUocG9pbnQsIHBvaW50LmZvcndhcmRDdXJ2ZSwgZG9jKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGhlbHBlcnMuaXNPYmplY3QocG9pbnQuYmFja3dhcmRDdXJ2ZSkpe1xuICAgICAgICAgICAgcmVmQ29udGFpbi5iYWNrSGFuZGxlID0gZHJhd0hhbmRsZShwb2ludCwgcG9pbnQuYmFja3dhcmRDdXJ2ZSwgZG9jKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZy5kcmFnKCk7XG5cbiAgICAgICAgcmVmQ29udGFpbi5ncm91cCA9IGc7XG5cbiAgICAgICAgcmV0dXJuIHJlZkNvbnRhaW47XG4gICAgfTtcblxufVxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhdmlkaGlsbCBvbiAwMi8wOC8yMDE2LlxuICovXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCkge1xuICAgIGxldCBrZXlGcmFtZXMgPSBbXTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHNldEtleUZyYW1lcyhrZXlzKXtcbiAgICAgICAgICAgIGtleUZyYW1lcyA9IGtleXM7XG4gICAgICAgICAgICByZXR1cm4ga2V5RnJhbWVzO1xuXG4gICAgICAgIH0sXG4gICAgICAgIGdldEtleUZyYW1lcygpe1xuICAgICAgICAgICAgcmV0dXJuIGtleUZyYW1lcztcbiAgICAgICAgfSxcbiAgICAgICAgYWRkS2V5RnJhbWUoa2V5KXtcbiAgICAgICAgICAgIGlmKGtleS5oYXNPd25Qcm9wZXJ0eSgnb2Zmc2V0Jykpe1xuICAgICAgICAgICAgICAgIGtleUZyYW1lcy5wdXNoKGtleSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0tleWZyYW1lcyBzaG91bGQgaGF2ZSBhbiBvZmZzZXQgcHJvcGVydHknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVtb3ZlS2V5RnJhbWUoaW5kZXgpe1xuICAgICAgICAgICAga2V5RnJhbWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICByZXR1cm4ga2V5RnJhbWVzO1xuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVLZXlPZmZzZXQoaW5kZXgsIG5ld09mZnNldCl7XG4gICAgICAgICAgICBrZXlGcmFtZXNbaW5kZXhdLm9mZnNldCA9IG5ld09mZnNldDtcbiAgICAgICAgICAgIHJldHVybiBrZXlGcmFtZXNbaW5kZXhdO1xuICAgICAgICB9XG5cbiAgICB9O1xufVxuIiwiXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgaXNPYmplY3Q6IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCc7IC8vIGNvdXJ0ZXN5IG9mIGFuZ3VsYXJqc1xuICAgIH0sXG4gICAgZGVjaW1hbFRvUGVyY2VudGFnZTogZnVuY3Rpb24oZGVjKXtcbiAgICAgICAgcmV0dXJuICggZGVjICogMTAwICkudG9GaXhlZCgyKSArICclJztcbiAgICB9LFxuICAgIHRvVGltZVNjYWxlOiBmdW5jdGlvbiAodmFsLCB0b3RhbCkge1xuICAgICAgICByZXR1cm4gKHRvdGFsKnZhbCkudG9GaXhlZCgyKSArICdtcyc7XG4gICAgfSxcbiAgICB0b1NwYWNlZFN0cmluZzogZnVuY3Rpb24gKC4uLnN0cmluZ3MpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZ3Muam9pbignICcpO1xuICAgIH1cbn07XG4iLCJpbXBvcnQgaGVscGVycyBmcm9tICcuLi9oZWxwZXJzLmpzJztcblxuZXhwb3J0IGNvbnN0IHNlZ21lbnRNZXRob2RzID0ge1xuICAgIGN1YmljQmV6aWVyKHBvaW50QSwgcG9pbnRCKSB7XG4gICAgICAgIGxldCBjb250cm9sUG9pbnQgPSBbXTtcblxuICAgICAgICBjb250cm9sUG9pbnRbMF0gPSAnTScgKyBoZWxwZXJzLnRvU3BhY2VkU3RyaW5nKHBvaW50QS54LCBwb2ludEEueSk7XG4gICAgICAgIGNvbnRyb2xQb2ludFsxXSA9ICdDJyArIGhlbHBlcnMudG9TcGFjZWRTdHJpbmcocG9pbnRBLmZvcndhcmRDdXJ2ZS54LCBwb2ludEEuZm9yd2FyZEN1cnZlLnkpO1xuXG4gICAgICAgIGNvbnRyb2xQb2ludFsyXSA9IGhlbHBlcnMudG9TcGFjZWRTdHJpbmcocG9pbnRCLmJhY2t3YXJkQ3VydmUueCwgcG9pbnRCLmJhY2t3YXJkQ3VydmUueSk7XG4gICAgICAgIGNvbnRyb2xQb2ludFszXSA9IGhlbHBlcnMudG9TcGFjZWRTdHJpbmcocG9pbnRCLngsIHBvaW50Qi55KTtcblxuICAgICAgICByZXR1cm4gY29udHJvbFBvaW50LmpvaW4oJyAnKTtcblxuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHBvaW50c0FycmF5KSB7XG5cbiAgICBsZXQgcmVzdWx0LFxuICAgICAgICBwYXRoU3RyQXJyID0gW107XG5cbiAgICBmb3IobGV0IGkgPSAwLCBsZW4gPSBwb2ludHNBcnJheS5sZW5ndGggLSAxOyBpIDwgbGVuOyBpKysgKXtcbiAgICAgICAgLy8gY3VydmUgYmV0d2VlbiBjdXJyZW50IHBvaW50IGFuZCBuZXh0XG4gICAgICAgIHJlc3VsdCA9IHNlZ21lbnRNZXRob2RzLmN1YmljQmV6aWVyKHBvaW50c0FycmF5W2ldLCBwb2ludHNBcnJheVtpKzFdKTtcbiAgICAgICAgcGF0aFN0ckFyci5wdXNoKHJlc3VsdCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhdGhTdHJBcnIuam9pbignICcpO1xuXG59XG4iLCJcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKHByZXZWYWwsIHBvaW50LCBpbmQsIHNyY0Fycil7XG5cbiAgICBsZXQgcHJldlBvaW50ID0gc3JjQXJyW2luZCAtIDFdO1xuICAgIGxldCBuZXh0UG9pbnQgPSBzcmNBcnJbaW5kICsgMV07XG5cbiAgICBpZihwcmV2UG9pbnQgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgIGxldCB4RGlmZiA9IHBvaW50LnggLSBwcmV2UG9pbnQueDtcblxuICAgICAgICAvLyBlYXNlT3V0ID0gY3ViaWMtYmV6aWVyKDAsMCwgMC41OCwxKVxuICAgICAgICBwb2ludC5iYWNrd2FyZEN1cnZlID0ge1xuICAgICAgICAgICAgeDogcG9pbnQueCAtICh4RGlmZiAqIDAuNTgpLCAvL1xuICAgICAgICAgICAgeTogcG9pbnQueSAvLyAxXG4gICAgICAgIH07XG5cbiAgICB9XG5cbiAgICBpZihuZXh0UG9pbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBsZXQgeERpZmYgPSBuZXh0UG9pbnQueCAtIHBvaW50Lng7XG5cbiAgICAgICAgLy8gZWFzZUluID0gY3ViaWMtYmV6aWVyKDAuNDIsMCwgMSwxKVxuICAgICAgICBwb2ludC5mb3J3YXJkQ3VydmUgPSB7XG4gICAgICAgICAgICB4OiBwb2ludC54ICsgKCB4RGlmZiAqIDAuNDIgKSxcbiAgICAgICAgICAgIHk6IHBvaW50LnkgLy8gMFxuICAgICAgICB9O1xuXG4gICAgfVxuXG4gICAgcHJldlZhbC5wdXNoKHBvaW50KTtcblxuICAgIHJldHVybiBwcmV2VmFsO1xuXG59Il19"}